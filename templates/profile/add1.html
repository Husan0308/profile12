<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://getbootstrap.com/docs/5.3/assets/css/docs.css" rel="stylesheet">
    <title>Bootstrap Example</title>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  </head>
  <body class="p-3 m-0 border-0 bd-example m-0 border-0">

    <!-- Example Code -->
    <div class="row">
        <h2>Personal Information</h2>
        <div class="col-6">
            <div class="input-group mb-3">
                <input type="text" class="form-control" name="name" placeholder="Full Name" aria-label="Full Name" aria-describedby="basic-addon1">
            </div>
            
            <div class="input-group mb-3">
                <input type="text" class="form-control" name="level" placeholder="Level" aria-label="Level" aria-describedby="basic-addon1">
            </div>

            
            <div class="input-group mb-3">
                <input type="text" class="form-control" name="phone" placeholder="Phone" aria-label="Phone" aria-describedby="basic-addon1">
            </div>

            <div class="input-group mb-3">
                <input type="text" class="form-control" name="email" placeholder="Email" aria-label="Email" aria-describedby="basic-addon1">
            </div>
            
            <div class="input-group mb-3">
                <input type="text" class="form-control" name="website" placeholder="Website" aria-label="Website" aria-describedby="basic-addon1">
            </div>

            
            <div class="input-group mb-3">
                <input type="text" class="form-control" name="location" placeholder="Location" aria-label="Username" aria-describedby="basic-addon1">
            </div>

            <div class="input-group mb-3">
                <input type="file" class="form-control" name="image" accept="image/*">
            </div>
            <div class="d-grid gap-2 col-6 mx-auto">
                <button type="button" onclick="save_personal()" class="btn btn-primary">Save</button>
            </div>
        </div>

        <h2>Education</h2>
        <div class="col-6">
            <div class="row education_box">
                <div class="input-group mb-3">
                    <input type="text" class="form-control" name="year" placeholder="Year" aria-label="Year" aria-describedby="basic-addon1">
                </div>
                
                <div class="input-group mb-3">
                    <input type="text" class="form-control" name="qualification" placeholder="Qualification" aria-label="Qualification" aria-describedby="basic-addon1">
                </div>

                <div class="input-group mb-3">
                    <input type="text" class="form-control" name="universityname" placeholder="University Name" aria-label="University Name" aria-describedby="basic-addon1">
                </div>
            </div>
            <div class="d-grid gap-2 col-6 mx-auto">
                <button type="button" onclick="add_education_box()" class="btn btn-primary">Add</button>
                <button type="button" onclick="save_education_box()" class="btn btn-primary">Save</button>
            </div>
        </div>


        <h2>Language</h2>
        <div class="col-6">
            <div class="row language_box">
                <div class="col-8">
                    <div class="input-group mb-3">
                        <input type="text" class="form-control" name="language" placeholder="Language" aria-label="Language" aria-describedby="basic-addon1">
                    </div>
                </div>
                <div class="col-4">
                    <div class="input-group mb-3">
                        <input type="number" class="form-control" name="language_level" placeholder="Value" aria-label="Value" aria-describedby="basic-addon1">
                    </div>
                </div>
            </div>
            <div class="d-grid gap-2 col-6 mx-auto">
                <button type="button" onclick="add_language_box()" class="btn btn-primary">Add</button>
                <button type="button" onclick="save_language_box()" class="btn btn-primary">Save</button>
            </div>
        </div>


        <h2>Profile</h2>
        <div class="col-6">
            <div class="row">
                <div class="input-group mb-3">
                    <input class="form-control" name="about" placeholder="About" aria-label="About" aria-describedby="basic-addon1">
                </div>
            </div>
            <div class="d-grid gap-2 col-6 mx-auto">
                <button type="button" onclick="save_profile_box()" class="btn btn-primary">Save</button>
            </div>
        </div>


        <h2>Experience</h2>
        <div class="col-6">
            <div class="row experience_box">
                <div class="input-group mb-3">
                    <input class="form-control" name="year_company" placeholder="Year Company" aria-label="Year Company" aria-describedby="basic-addon1">
                </div>
                <div class="input-group mb-3">
                    <input class="form-control" name="company_name" placeholder="Company Name" aria-label="Company Name" aria-describedby="basic-addon1">
                </div>
                <div class="input-group mb-3">
                    <input class="form-control" name="job" placeholder="Job" aria-label="Job" aria-describedby="basic-addon1">
                </div>
                <div class="input-group mb-3">
                    <input class="form-control" name="about_job" placeholder="About Your Job" aria-label="About Your Job" aria-describedby="basic-addon1">
                </div>
            </div>
            <div class="d-grid gap-2 col-6 mx-auto">
                <button type="button" onclick="add_experience_box()" class="btn btn-primary">Add</button>
                <button type="button" onclick="save_experience_box()" class="btn btn-primary">Save</button>
            </div>
        </div>

        <h2>Skill</h2>
        <div class="col-6 ">
            <div class="row skill_box">
                <div class="col-8">
                <div class="input-group mb-3">
                    <input type="text" class="form-control" name="skill" placeholder="Skill" aria-label="Skill" aria-describedby="basic-addon1">
                </div>
                </div>
                <div class="col-4">
                    <div class="input-group mb-3">
                        <input type="number" class="form-control" name="skill_level" placeholder="Value" aria-label="Value" aria-describedby="basic-addon1">
                    </div>
                </div>
            </div>
            <div class="d-grid gap-2 col-6 mx-auto">
                <button type="button" onclick="add_skill_box()" class="btn btn-primary">Add</button>
                <button type="button" onclick="save_skill_box()" class="btn btn-primary">Save</button>
            </div>
        </div>

        <h2>Interest</h2>
        <div class="col-6">
            <div class="row interest_box">
                <div class="input-group mb-3">
                    <input class="form-control" name="interests" placeholder="Your Interests" aria-label="Year Interests" aria-describedby="basic-addon1">
                </div>
            </div>
            
            <div class="d-grid gap-2 col-6 mx-auto">
                <button type="button" onclick="add_interest_box()" class="btn btn-primary">Add</button>
                <button type="button" onclick="save_interest_box()" class="btn btn-primary">Save</button>
            </div>
        </div>
    </div>
    <br><br>
    <hr>
    <div class="d-grid gap-2 col-6 mx-auto">
        <a class="btn btn-info" type="button" href="{% url 'home' %}">View</a>
    </div>
        
    
      
    <!-- End Example Code -->
    <foot>
        <script>

            function save_personal(){
                    // Create FormData object
                const formData = new FormData();
                
                // Add text inputs to FormData
                formData.append('name', document.querySelector('input[name="name"]').value);
                formData.append('level', document.querySelector('input[name="level"]').value);
                formData.append('phone', document.querySelector('input[name="phone"]').value);
                formData.append('email', document.querySelector('input[name="email"]').value);
                formData.append('website', document.querySelector('input[name="website"]').value);
                formData.append('location', document.querySelector('input[name="location"]').value);
                
                // Add image file to FormData
                const imageInput = document.querySelector('input[name="image"]');
                const imageFile = imageInput.files[0];
                formData.append('image', imageFile);

                function getCookie(name) {
                    const value = `; ${document.cookie}`;
                    const parts = value.split(`; ${name}=`);
                    if (parts.length === 2) return parts.pop().split(';').shift();
                }
                
                const csrfToken = getCookie('csrftoken');
                
                // Example: Send FormData to server using fetch
                fetch('/save-personal/', {
                    method: 'POST',
                    headers: {
                        'X-CSRFToken': csrfToken // Include CSRF token in headers
                    },
                    body: formData
                })
                .then(response => response.json())
                .then(data => {
                    console.log('Success:', data);
                    alert('File uploaded!')
                    // Handle success response from server
                })
                .catch(error => {
                    console.error('Error:', error);
                    // Handle error
                });
            }
            
            function add_skill_box(){
                skill_box_content = `
                <div class="col-8">
                    <div class="input-group mb-3">
                        <input type="text" class="form-control" name="skill" placeholder="Skill" aria-label="Skill" aria-describedby="basic-addon1">
                    </div>
                </div>
                <div class="col-4">
                    <div class="input-group mb-3">
                        <input type="number" class="form-control" name="skill_level" placeholder="Value" aria-label="Value" aria-describedby="basic-addon1">
                    </div>
                </div>
                `

                skill_box = document.getElementsByClassName('skill_box')[0]
                skill_box.innerHTML += skill_box_content

            }

            function save_skill_box(){
                const formData = new FormData();
                
                // Add text inputs to FormData
                skill_inputs = document.querySelectorAll('input[name="skill"]')
                skill_level_inputs = document.querySelectorAll('input[name="skill_level"]')
                body = []
                for (i=0; i<skill_inputs.length; i++) {
                    body.push({
                        'skill': skill_inputs[i].value,
                        'skill_level': skill_level_inputs[i].value
                    })
                }
                formData.append('data', JSON.stringify(body));

 
                function getCookie(name) {
                    const value = `; ${document.cookie}`;
                    const parts = value.split(`; ${name}=`);
                    if (parts.length === 2) return parts.pop().split(';').shift();
                }
                
                const csrfToken = getCookie('csrftoken');
                
                // Example: Send FormData to server using fetch
                fetch('/save_skill_box/', {
                    method: 'POST',
                    headers: {
                        'X-CSRFToken': csrfToken // Include CSRF token in headers
                    },
                    body: formData
                })
                .then(response => response.json())
                .then(data => {
                    console.log('Success:', data);
                    alert('File uploaded!')
                    // Handle success response from server
                })
                .catch(error => {
                    console.error('Error:', error);
                    // Handle error
                });



                // Initialize an empty array to store skills
                let skills = [];

                // Select all skill_box elements with class 'row skill_box'
                const skillBoxes = document.querySelectorAll('.skill_box');

                // Loop through each skill_box element
                skillBoxes.forEach(skillBox => {
                    // Select all input elements within the current skill_box
                    const inputs = skillBox.querySelectorAll('input');

                    // Loop through each pair of input elements (assuming skill and value inputs alternate)
                    for (let i = 0; i < inputs.length; i += 2) {
                        // Get the skill name (assuming it's the input at index i)
                        const skillName = inputs[i].value.trim(); // Use .trim() to remove any leading or trailing whitespace
                        
                        // Get the skill value (assuming it's the input immediately after the skill name input)
                        const skillValue = parseInt(inputs[i + 1].value); // Convert to integer
                        
                        // Check if both skillName and skillValue are valid
                        if (skillName && !isNaN(skillValue)) {
                            // Add the skill to the skills array as a dictionary
                            skills.push({'name': skillName, 'value': skillValue});
                        }
                    }
                });
                console.log(skills)
            }

            function add_education_box(){
                education_box_content = `
                    <div class="input-group mb-3">
                        <input type="text" class="form-control" name="year" placeholder="Year" aria-label="Year" aria-describedby="basic-addon1">
                    </div>
                    
                    <div class="input-group mb-3">
                        <input type="text" class="form-control" name="qualification" placeholder="Qualification" aria-label="Qualification" aria-describedby="basic-addon1">
                    </div>

                    <div class="input-group mb-3">
                        <input type="text" class="form-control" name="universityname" placeholder="University Name" aria-label="University Name" aria-describedby="basic-addon1">
                    </div>
                `

                education_box = document.getElementsByClassName('education_box')[0]
                education_box.innerHTML += education_box_content

            }

            function save_education_box(){


                const formData = new FormData();

                // Add text inputs to FormData
                year_inputs = document.querySelectorAll('input[name="year"]')
                qualification_inputs = document.querySelectorAll('input[name="qualification"]')
                universityname_inputs = document.querySelectorAll('input[name="universityname"]')
                body = []
                for (i=0; i<year_inputs.length; i++) {
                    body.push({
                        'year': year_inputs[i].value,
                        'qualification': qualification_inputs[i].value,
                        'universityname': universityname_inputs[i].value,
                    })
                }
                formData.append('data', JSON.stringify(body));


                function getCookie(name) {
                    const value = `; ${document.cookie}`;
                    const parts = value.split(`; ${name}=`);
                    if (parts.length === 2) return parts.pop().split(';').shift();
                }

                const csrfToken = getCookie('csrftoken');

                // Example: Send FormData to server using fetch
                fetch('/save_education_box/', {
                    method: 'POST',
                    headers: {
                        'X-CSRFToken': csrfToken // Include CSRF token in headers
                    },
                    body: formData
                })
                .then(response => response.json())
                .then(data => {
                    console.log('Success:', data);
                    alert('File uploaded!')
                    // Handle success response from server
                })
                .catch(error => {
                    console.error('Error:', error);
                    // Handle error
                });
            }

            function add_language_box(){
                language_box_content = `
                <div class="col-8">
                    <div class="input-group mb-3">
                        <input type="text" class="form-control" name="language" placeholder="Language" aria-label="Language" aria-describedby="basic-addon1">
                    </div>
                </div>
                <div class="col-4">
                    <div class="input-group mb-3">
                        <input type="text" class="form-control" name="language_level" placeholder="Value" aria-label="Value" aria-describedby="basic-addon1">
                    </div>
                </div>
                `

                language_box = document.getElementsByClassName('language_box')[0]
                language_box.innerHTML += language_box_content

            }

            function save_language_box(){

                const formData = new FormData();

                // Add text inputs to FormData
                language_inputs = document.querySelectorAll('input[name="language"]')
                language_level_inputs = document.querySelectorAll('input[name="language_level"]')
                body = []
                for (i=0; i<language_inputs.length; i++) {
                    body.push({
                        'language': language_inputs[i].value,
                        'level': language_level_inputs[i].value
                    })
                }
                formData.append('data', JSON.stringify(body));


                function getCookie(name) {
                    const value = `; ${document.cookie}`;
                    const parts = value.split(`; ${name}=`);
                    if (parts.length === 2) return parts.pop().split(';').shift();
                }

                const csrfToken = getCookie('csrftoken');

                // Example: Send FormData to server using fetch
                fetch('/save_language_box/', {
                    method: 'POST',
                    headers: {
                        'X-CSRFToken': csrfToken // Include CSRF token in headers
                    },
                    body: formData
                })
                .then(response => response.json())
                .then(data => {
                    console.log('Success:', data);
                    alert('File uploaded!')
                    // Handle success response from server
                })
                .catch(error => {
                    console.error('Error:', error);
                    // Handle error
                });
            }

            function save_profile_box(){

                const formData = new FormData();

                // Add text inputs to FormData
                formData.append('about', document.querySelector('input[name="about"]').value);


                function getCookie(name) {
                    const value = `; ${document.cookie}`;
                    const parts = value.split(`; ${name}=`);
                    if (parts.length === 2) return parts.pop().split(';').shift();
                }

                const csrfToken = getCookie('csrftoken');

                // Example: Send FormData to server using fetch
                fetch('/save_profile_box/', {
                    method: 'POST',
                    headers: {
                        'X-CSRFToken': csrfToken // Include CSRF token in headers
                    },
                    body: formData
                })
                .then(response => response.json())
                .then(data => {
                    console.log('Success:', data);
                    alert('File uploaded!')
                    // Handle success response from server
                })
                .catch(error => {
                    console.error('Error:', error);
                    // Handle error
                });
            }

            function add_experience_box(){
                experience_box_content = `
                    <div class="input-group mb-3">
                        <input class="form-control" name="year_company" placeholder="Year Company" aria-label="Year Company" aria-describedby="basic-addon1">
                    </div>
                    <div class="input-group mb-3">
                        <input class="form-control" name="company_name" placeholder="Company Name" aria-label="Company Name" aria-describedby="basic-addon1">
                    </div>
                    <div class="input-group mb-3">
                        <input class="form-control" name="job" placeholder="Job" aria-label="Job" aria-describedby="basic-addon1">
                    </div>
                    <div class="input-group mb-3">
                        <input class="form-control" name="about_job" placeholder="About Your Job" aria-label="About Your Job" aria-describedby="basic-addon1">
                    </div>
                `

                experience_box = document.getElementsByClassName('experience_box')[0]
                experience_box.innerHTML += experience_box_content

            }
            
            function save_experience_box(){


                const formData = new FormData();

                // Add text inputs to FormData
                year_company_inputs = document.querySelectorAll('input[name="year_company"]')
                company_name_inputs = document.querySelectorAll('input[name="company_name"]')
                job_inputs = document.querySelectorAll('input[name="job"]')
                about_job_inputs = document.querySelectorAll('input[name="about_job"]')
                body = []
                for (i=0; i<year_company_inputs.length; i++) {
                    body.push({
                        'year_company': year_company_inputs[i].value,
                        'company_name': company_name_inputs[i].value,
                        'job': job_inputs[i].value,
                        'about_job': about_job_inputs[i].value,
                    })
                }
                formData.append('data', JSON.stringify(body));


                function getCookie(name) {
                    const value = `; ${document.cookie}`;
                    const parts = value.split(`; ${name}=`);
                    if (parts.length === 2) return parts.pop().split(';').shift();
                }

                const csrfToken = getCookie('csrftoken');

                // Example: Send FormData to server using fetch
                fetch('/save_experience_box/', {
                    method: 'POST',
                    headers: {
                        'X-CSRFToken': csrfToken // Include CSRF token in headers
                    },
                    body: formData
                })
                .then(response => response.json())
                .then(data => {
                    console.log('Success:', data);
                    alert('File uploaded!')
                    // Handle success response from server
                })
                .catch(error => {
                    console.error('Error:', error);
                    // Handle error
                });
            }

            function add_interest_box(){

                interest_box_content = `
                    <div class="input-group mb-3">
                        <input class="form-control" name="interests" placeholder="Your Interests" aria-label="Year Interests" aria-describedby="basic-addon1">
                    </div>
                `
                

                interest_box = document.getElementsByClassName('interest_box')[0]
                interest_box.innerHTML += interest_box_content

            }

            function save_interest_box(){

                const formData = new FormData();

                // Add text inputs to FormData
                interests_inputs = document.querySelectorAll('input[name="interests"]')
                body = []
                for (i=0; i<interests_inputs.length; i++) {
                    body.push({
                        'interests': interests_inputs[i].value
                    })
                }
                formData.append('data', JSON.stringify(body));


                function getCookie(name) {
                    const value = `; ${document.cookie}`;
                    const parts = value.split(`; ${name}=`);
                    if (parts.length === 2) return parts.pop().split(';').shift();
                }

                const csrfToken = getCookie('csrftoken');

                // Example: Send FormData to server using fetch
                fetch('/save_interest_box/', {
                    method: 'POST',
                    headers: {
                        'X-CSRFToken': csrfToken // Include CSRF token in headers
                    },
                    body: formData
                })
                .then(response => response.json())
                .then(data => {
                    console.log('Success:', data);
                    alert('File uploaded!')
                    // Handle success response from server
                })
                .catch(error => {
                    console.error('Error:', error);
                    // Handle error
                });
            }

        </script>
    </foot>
  </body>
</html>